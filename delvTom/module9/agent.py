
import random

class Agent:
    def __init__(self, env):
        self.env = env
        self.Q = [[0.397251, 0.395959, 0.399603, 0.414715], [0.404577, 0.410033, 0.427329, 0.403338], [0.417335, 0.425578, 0.453158, 0.42714], [0.432917, 0.444449, 0.478249, 0.433054], [0.458756, 0.460853, 0.497127, 0.453664], [0.48313, 0.481874, 0.517703, 0.481729], [0.510545, 0.510349, 0.529399, 0.511517], [0.511136, 0.51852, 0.535591, 0.51052], [0.38193, 0.384077, 0.383324, 0.412632], [0.395414, 0.392157, 0.393703, 0.42324], [0.40876, 0.396026, 0.401265, 0.441401], [0.267527, 0.322481, 0.277483, 0.469546], [0.439422, 0.439021, 0.44767, 0.488795], [0.472467, 0.47207, 0.516007, 0.482323], [0.519923, 0.514182, 0.539994, 0.51991], [0.52458, 0.556216, 0.533257, 0.529588], [0.359195, 0.350021, 0.357733, 0.381088], [0.345815, 0.344634, 0.343368, 0.380046], [0.37015, 0.14717, 0.10803, 0.23811], [0.0, 0.0, 0.0, 0.0], [0.258115, 0.253532, 0.436208, 0.343567], [0.247425, 0.325722, 0.263707, 0.499969], [0.517229, 0.540372, 0.55481, 0.527227], [0.553127, 0.581682, 0.567061, 0.55224], [0.307296, 0.299694, 0.311601, 0.352512], [0.290133, 0.272096, 0.254861, 0.349052], [0.213787, 0.201759, 0.172716, 0.314419], [0.036353, 0.219481, 0.018213, 0.086726], [0.303233, 0.133705, 0.167071, 0.216948], [0.0, 0.0, 0.0, 0.0], [0.391279, 0.346353, 0.564914, 0.377495], [0.590671, 0.598334, 0.636788, 0.579271], [0.320317, 0.213482, 0.240898, 0.240379], [0.081714, 0.015166, 0.10482, 0.28442], [0.044834, 0.042083, 0.041912, 0.141599], [0.0, 0.0, 0.0, 0.0], [0.155126, 0.173942, 0.283623, 0.196238], [0.160855, 0.370596, 0.16577, 0.23831], [0.291717, 0.326527, 0.457388, 0.537972], [0.661017, 0.64758, 0.705725, 0.618416], [0.29403, 0.132276, 0.225787, 0.226351], [0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0], [0.008445, 0.047574, 0.063801, 0.034907], [0.075126, 0.121037, 0.132748, 0.203217], [0.268281, 0.128675, 0.184187, 0.175714], [0.0, 0.0, 0.0, 0.0], [0.539345, 0.599893, 0.770915, 0.492698], [0.279066, 0.212217, 0.207783, 0.122073], [0.0, 0.0, 0.0, 0.0], [0.008873, 0.003432, 0.060264, 0.008507], [0.017313, 0.018726, 0.009667, 0.036734], [0.0, 0.0, 0.0, 0.0], [0.158371, 0.096446, 0.283178, 0.053744], [0.0, 0.0, 0.0, 0.0], [0.5959, 0.691638, 0.882248, 0.584237], [0.269826, 0.180862, 0.18721, 0.205036], [0.133826, 0.207778, 0.070254, 0.061138], [0.146696, 0.028672, 0.024283, 0.073729], [0.0, 0.0, 0.0, 0.0], [0.023083, 0.117613, 0.199708, 0.025863], [0.310545, 0.340708, 0.498534, 0.273169], [0.365632, 0.705332, 0.603579, 0.46811], [0.0, 0.0, 0.0, 0.0]]
        self.nS = len(self.Q)
        self.nA = len(self.Q[0]) if self.nS>0 else env.action_space.n
        self.rng = random.Random(0)

    def choose_action(self, observation, reward=0.0, terminated=False, truncated=False, info=None):
        s = int(observation)
        if s < 0 or s >= self.nS:
            return self.env.action_space.sample()
        row = self.Q[s]
        m = max(row)
        candidates = [a for a, v in enumerate(row) if v == m]
        return self.rng.choice(candidates)
